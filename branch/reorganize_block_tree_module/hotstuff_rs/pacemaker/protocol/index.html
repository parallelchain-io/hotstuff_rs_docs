<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Implementation of the Pacemaker protocol, based on the Lewis-Pye View Synchronisation protocol and the Interleaved Weighted Round Robin leader selection mechanism."><title>hotstuff_rs::pacemaker::protocol - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="hotstuff_rs" data-themes="" data-resource-suffix="" data-rustdoc-version="1.83.0 (90b35a623 2024-11-26)" data-channel="1.83.0" data-search-js="search-f0d225181b97f9a4.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../hotstuff_rs/index.html">hotstuff_<wbr>rs</a><span class="version">0.4.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module protocol</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#view-synchronisation" title="View Synchronisation">View Synchronisation</a></li><li><a href="#leader-selection" title="Leader Selection">Leader Selection</a></li></ul><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#functions" title="Functions">Functions</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="../index.html">In hotstuff_<wbr>rs::<wbr>pacemaker</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../index.html">hotstuff_rs</a>::<wbr><a href="../index.html">pacemaker</a></span><h1>Module <span>protocol</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/hotstuff_rs/pacemaker/protocol.rs.html#6-780">source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Implementation of the Pacemaker protocol, based on the
<a href="https://arxiv.org/pdf/2201.01107.pdf">Lewis-Pye View Synchronisation protocol</a> and the Interleaved
Weighted Round Robin leader selection mechanism.</p>
<p>The liveness of the HotStuff protocol is dependent on the Pacemaker module, which regulates how and
when a replica advances its view, as well as determines which validator shall act as the leader of
a given view.</p>
<h3 id="view-synchronisation"><a class="doc-anchor" href="#view-synchronisation">Â§</a>View Synchronisation</h3>
<p>The goal is to ensure that at any point all honest replicas should eventually end up in the same
view and stay there for long enough to enable consensus through forming a PC. Just like the HotStuff
SMR, the Pacemaker protocol is Byzantine Fault Tolerant: eventual succesful view synchronization is
guaranteed in the presence of n = 3f + 1 validators where at most f validators are Byzantine.</p>
<p>The Lewis-Pye Pacemaker achieves view synchronisation by dividing the sequence of views into epochs.
The mechanism for advancing the view depends on whether a view is advanced within the same epoch or
involves epoch change:</p>
<ol>
<li>All-to-all broadcast in every epoch-change view (i.e., last view of an epoch) upon which replicas
enter the next epoch and set their timeout deadlines for all views in the next epoch,</li>
<li>Advancing to a next view within the same epoch either on timeout or optimistically on receiving a
PC for their current view.</li>
</ol>
<p>The latter ensures synchronisation when timeouts are set in a uniform manner and when leaders are
honest, and the former serves as a fallback mechanism in case views fall out of sync.</p>
<p>This protocol deviates from Lewis-Pye in two fundamental ways:</p>
<ol>
<li>Epoch length is configurable, rather than equal to f+1. This is to enable dynamic validator sets.</li>
<li><a href="../messages/struct.TimeoutVote.html" title="struct hotstuff_rs::pacemaker::messages::TimeoutVote"><code>TimeoutVote</code></a>s include a highest_tc the sender knows. This provides a fallback mechanism for
helping validators lagging behind on epoch number catch up with the validators ahead.</li>
</ol>
<h3 id="leader-selection"><a class="doc-anchor" href="#leader-selection">Â§</a>Leader Selection</h3>
<p>Leaders are selected according to Interleaved Weighted Round Robin algorithm. This ensures that:</p>
<ol>
<li>The frequency with which a validator is selected as a leader is proportional to the validatorâ€™s
power,</li>
<li>Validators are selected as leaders in an interleaved manner: unless a validator has more power
than any other validator, it will never act as a leader for more than one consecutive view.</li>
</ol>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Pacemaker.html" title="struct hotstuff_rs::pacemaker::protocol::Pacemaker">Pacemaker</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">A Pacemaker protocol for Byzantine View Synchronization inspired by the
<a href="https://arxiv.org/pdf/2201.01107.pdf">Lewis-Pye View Synchronization protocol</a>. Its
<a href="struct.PacemakerState.html" title="struct hotstuff_rs::pacemaker::protocol::PacemakerState"><code>PacemakerState</code></a> is the authoritative source of information regarding the current view and its
leader, and <a href="../../algorithm/struct.Algorithm.html" title="struct hotstuff_rs::algorithm::Algorithm"><code>Algorithm</code></a> should regularly query the <a href="struct.Pacemaker.html" title="struct hotstuff_rs::pacemaker::protocol::Pacemaker"><code>Pacemaker</code></a> for
this information (<a href="struct.ViewInfo.html" title="struct hotstuff_rs::pacemaker::protocol::ViewInfo"><code>ViewInfo</code></a>), and propagate the information to <a href="../../hotstuff/index.html" title="mod hotstuff_rs::hotstuff"><code>hotstuff</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.PacemakerConfiguration.html" title="struct hotstuff_rs::pacemaker::protocol::PacemakerConfiguration">Pacemaker<wbr>Configuration</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Immutable parameters that determine the behaviour of the <a href="struct.Pacemaker.html" title="struct hotstuff_rs::pacemaker::protocol::Pacemaker"><code>Pacemaker</code></a> and should never change after
a replica starts.</div></li><li><div class="item-name"><a class="struct" href="struct.PacemakerState.html" title="struct hotstuff_rs::pacemaker::protocol::PacemakerState">Pacemaker<wbr>State</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Internal state of the <a href="struct.Pacemaker.html" title="struct hotstuff_rs::pacemaker::protocol::Pacemaker"><code>Pacemaker</code></a>. Keeps track of the timeouts allocated to current and future views
(if any), and the <a href="../messages/struct.TimeoutVote.html" title="struct hotstuff_rs::pacemaker::messages::TimeoutVote">timeout votes</a> collected for the current view.</div></li><li><div class="item-name"><a class="struct" href="struct.ViewInfo.html" title="struct hotstuff_rs::pacemaker::protocol::ViewInfo">View<wbr>Info</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Describes a view (most often the current view), in terms of its view number and its view deadline (the
instant in time in which the view should end if no progress was made).</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.ExtendViewError.html" title="enum hotstuff_rs::pacemaker::protocol::ExtendViewError">Extend<wbr>View<wbr>Error</a></div><div class="desc docblock-short">Extending the view can fail in two ways:</div></li><li><div class="item-name"><a class="enum" href="enum.PacemakerError.html" title="enum hotstuff_rs::pacemaker::protocol::PacemakerError">Pacemaker<wbr>Error</a></div><div class="desc docblock-short">The pacemaker can fail in two fundamental ways:</div></li><li><div class="item-name"><a class="enum" href="enum.UpdateViewError.html" title="enum hotstuff_rs::pacemaker::protocol::UpdateViewError">Update<wbr>View<wbr>Error</a></div><div class="desc docblock-short">Updating the view can fail in two ways:</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">Â§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.epoch.html" title="fn hotstuff_rs::pacemaker::protocol::epoch">epoch</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Compute the current epoch based on the current <code>view</code> and the configured <code>epoch_length</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.is_epoch_change_view.html" title="fn hotstuff_rs::pacemaker::protocol::is_epoch_change_view">is_<wbr>epoch_<wbr>change_<wbr>view</a><span title="Restricted Visibility">&nbsp;ðŸ”’</span> </div><div class="desc docblock-short">Check whether <code>view</code> is an epoch-change view given the configured <code>epoch_length</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.select_leader.html" title="fn hotstuff_rs::pacemaker::protocol::select_leader">select_<wbr>leader</a></div><div class="desc docblock-short">Implements the <a href="https://en.wikipedia.org/wiki/Weighted_round_robin#Interleaved_WRR">Interleaved Weighted Round Robin</a>
algorithm for selecting a view leader. For internal use by the <a href="struct.Pacemaker.html" title="struct hotstuff_rs::pacemaker::protocol::Pacemaker"><code>Pacemaker</code></a> and <a href="struct.PacemakerState.html" title="struct hotstuff_rs::pacemaker::protocol::PacemakerState"><code>PacemakerState</code></a> methods.</div></li></ul></section></div></main></body></html>